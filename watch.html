<!DOCTYPE html>
<html>
<head>
  <title>Watch Video - ZKG Live</title>
  <meta charset="UTF-8">

  <style>
    body{
      font-family: Arial, sans-serif;
      background:#f1f1f1;
      margin:0;
    }
    .container{
      display:flex;
      padding:20px;
      gap:20px;
    }
    .main{
      flex:3;
      background:#fff;
      padding:15px;
      border-radius:8px;
    }
    .side{
      flex:1;
    }
    video{
      width:100%;
      border-radius:6px;
    }
    .card{
      background:#fff;
      padding:10px;
      margin-bottom:15px;
      border-radius:6px;
      cursor:pointer;
    }
    .card video{
      width:100%;
    }
    .tags{
      color:#666;
      font-size:13px;
    }
  </style>
</head>

<body>

<div class="container">

  <!-- MAIN VIDEO -->
  <div class="main">
    <video id="mainVideo" controls></video>

    <h2 id="title"></h2>
    <p id="description"></p>
    <p class="tags" id="tags"></p>
  </div>

  <!-- RELATED VIDEOS -->
  <div class="side">
    <h3>ðŸ”¥ Related Videos</h3>
    <div id="related"></div>
  </div>

</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
/* Firebase Config */
const firebaseConfig = {
  apiKey: "AIzaSyCKqRPWM-3C5N-mPAN1lMf_m9CedLIfVSQ",
  authDomain: "zkg-live.firebaseapp.com",
  projectId: "zkg-live",
  storageBucket: "zkg-live.appspot.com",
  messagingSenderId: "1013280789722",
  appId: "1:1013280789722:web:8a561f796c6fda205b01e3"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

/* GET VIDEO ID */
const params = new URLSearchParams(window.location.search);
const videoId = params.get("id");

/* LOAD MAIN VIDEO */
db.collection("videos").doc(videoId).get().then(doc => {
  if(doc.exists){
    const v = doc.data();
    document.getElementById("mainVideo").src = v.url;
    document.getElementById("title").innerText = v.title;
    document.getElementById("description").innerText = v.description;
    document.getElementById("tags").innerText = v.tags ? "ðŸ·ï¸ " + v.tags : "";
  }
});

/* LOAD RELATED VIDEOS */
db.collection("videos")
  .orderBy("time","desc")
  .limit(6)
  .get()
  .then(snapshot => {
    snapshot.forEach(doc => {
      if(doc.id !== videoId){
        const v = doc.data();
        document.getElementById("related").innerHTML += `
          <div class="card" onclick="location.href='watch.html?id=${doc.id}'">
            <video muted>
              <source src="${v.url}" type="video/mp4">
            </video>
            <p><b>${v.title}</b></p>
          </div>
        `;
      }
    });
  });
</script>

</body>
</html>
