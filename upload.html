<!DOCTYPE html>
<html>
<head>
  <title>Upload Video - ZKG Live</title>
</head>

<body>

<h2>Upload Video</h2>

<!-- Video Preview -->
<video id="preview" width="320" controls style="display:none;"></video>
<br><br>

<!-- Title -->
<input type="text" id="title" placeholder="Video Title">
<br><br>

<!-- Description -->
<textarea id="description" placeholder="Video Description" rows="4" cols="40"></textarea>
<br><br>

<!-- Tags -->
<input type="text" id="tags" placeholder="Tags (comma separated)">
<br><br>

<!-- Video File -->
<input type="file" id="videoFile" accept="video/*">
<br><br>

<button onclick="uploadVideo()">Upload</button>

<p id="status"></p>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

<script>
/* Firebase Config */
const firebaseConfig = {
  apiKey: "AIzaSyCKqRPWM-3C5N-mPAN1lMf_m9CedLIfVSQ",
  authDomain: "zkg-live.firebaseapp.com",
  projectId: "zkg-live",
  storageBucket: "zkg-live.appspot.com",
  appId: "1:1013280789722:web:8a561f796c6fda205b01e3"
};

/* Initialize Firebase */
firebase.initializeApp(firebaseConfig);

const db = firebase.firestore();
const storage = firebase.storage();

/* Video Preview */
document.getElementById("videoFile").addEventListener("change", function () {
  const file = this.files[0];
  if (file) {
    const video = document.getElementById("preview");
    video.src = URL.createObjectURL(file);
    video.style.display = "block";
  }
});

/* Upload Function */
function uploadVideo() {
  const title = document.getElementById("title").value;
  const description = document.getElementById("description").value;
  const tags = document.getElementById("tags").value;
  const file = document.getElementById("videoFile").files[0];

  if (!title || !file) {
    alert("Title aur video zaroori hai");
    return;
  }

  document.getElementById("status").innerText = "Uploading...";

  const ref = storage.ref("videos/" + Date.now() + "_" + file.name);

  ref.put(file)
    .then(() => ref.getDownloadURL())
    .then(url => {
      return db.collection("videos").add({
        title: title,
        description: description,
        tags: tags,
        url: url,
        time: firebase.firestore.FieldValue.serverTimestamp()
      });
    })
    .then(() => {
      document.getElementById("status").innerText = "✅ Video Uploaded Successfully!";
    })
    .catch(error => {
      document.getElementById("status").innerText = "❌ ERROR: " + error.message;
      console.error(error);
    });
}
</script>

</body>
</html>
